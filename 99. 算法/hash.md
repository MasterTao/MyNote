## hash特点

1. 输入是无穷大的；
2. 输出是有限的；
3. 无随机机制；same in --> same out；
4. 不同的输入，相同的输出（哈希碰撞）；
5. 离散性（均匀性）

#### 应用

##### 40亿个无符号整数的文件，1G内存，统计出现次数最多的数

>1G内存全部去做hash表，key 4字节，value 4字节，一条记录8字节，如果40亿个数全不一样，需要320亿字节（32G），所以不能这么做
>
>保守估计，1G内存最多能放1亿个数；每个数 通过 hash函数计算得到一个hash值，然后将hash值模40，根据返回值，放到不同文件中。
>
>然后用1G内存，依次统计0号文件，1号文件等等文件中出现次数最多的数，最后判断哪个数出现次数最多。

## 实现

Hash每个桶长度过长时，需要扩容

Hash冲突挂载的链表可以使用有序表

## bloom过滤器

#### 简单原理

通过K个hash函数算出k个hash值，模M，放到位图中。

查询时，算出k个hash函数的值，模M，比较

#### 事务类型

不准确：不存在，但是误报为存在；不会出现存在的误报为不存在；

#### 要确定的值 K 和 M

>要先知道样本量和预期失误率，要确定K和M
>
>有三个重要的公式
>
>K个hash函数如何找？？？
>
>f() + 1 * g()；通过这种方式

#### 应用

hdfs分布式文件系统

## 一致性hash

#####  解决什么问题

数据迁移和负载均衡

一致性hash里面都是hash值，不取模

hash环的概念

虚拟节点概念

#### 应用

如何推荐每个人周围几百米以内的店？？

>将所有店经度纬度映射到网格上，人所在的经纬度也映射到网格上，找到小人所在网格周围几百米的网格，找到店，再通过商家经纬度和人的经纬度精确判断

